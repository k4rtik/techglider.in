<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Control All Computers in a Lab from a Single System &#183; The TechGlider</title><link rel=stylesheet href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" type=text/css><link rel=stylesheet href=techglider.inlibraries/normalize.3.0.1.css><link rel=stylesheet href=techglider.incss/liquorice.css><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script></head><body class=li-body><style type=text/css>input.gsc-input,.gsc-input-box,.gsc-input-box-hover,.gsc-input-box-focus,.gsc-search-button{box-sizing:content-box;line-height:normal}.gs-title{line-height:normal}table.gsc-table-result{border-collapse:separate}.gsc-input-box input{color:#000}.gsc-control-cse{padding:.1em 0 .5em 1em!important;width:14em!important;float:right;line-height:normal}input.gsc-search-button-v2{padding:6px 12px!important}.gsc-search-box-tools .gsc-search-box .gsc-input{padding-right:1px!important}</style><header class=li-page-header><div class=container><div class=row><div class="sixteen columns"><div class="li-brand li-left"><a href=techglider.in>The TechGlider</a></div><div class="li-menu li-right"><span class=li-menu-icon onclick='toggle("menu")'>&#9776;</span><ul id=menu2 class=li-menu-items><li><a href=techglider.in/post>Posts</a></li><li><a href=techglider.in/quote>Quotes</a></li><li><a href=techglider.in/status>Statuses</a></li><li><a href=techglider.in/about>About</a></li><li><script>(function(){var t,n="partner-pub-4463712641758053:o1e85jn1rm4",e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=(document.location.protocol=="https:"?"https:":"http:")+"//www.google.com/cse/cse.js?cx="+n,t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script><gcse:search></gcse:search></li></ul></div></div></div><div class=row><div class="sixteen columns"><ul id=menu class="li-menu-items li-menu-mobile"><li><a href=techglider.in/post>Posts</a></li><li><a href=techglider.in/quote>Quotes</a></li><li><a href=techglider.in/status>Statuses</a></li><li><a href=techglider.in/about>About</a></li><li><gcse:search></gcse:search></li></ul></div></div></div></header><div class=container><div class=row><div class="sixteen columns"><article class=li-article><header class=li-article-header><h1 class=li-article-title>Control All Computers in a Lab from a Single System</h1><time class=li-article-date>Sunday, February 12, 2012</time></header><section><p>Quoting <a href=http://dhand33p.wordpress.com/>Dhandeep</a>, our super-cool lab-admin:</p><blockquote><p>now , all 70 systems in the lab can be switched on and switched off by single commands from the hostel&mldr;</p></blockquote><p>Yes, that and a lot more is possible in our <a href=http://athena.nitc.ac.in/ssl/>Software Systems Lab</a> now. How? Read on&mldr;</p><h2 id=the-setup>The Setup</h2><p>We have over 70 systems with Ubuntu 10.04 LTS installed on them. There is an administrative account (let&rsquo;s call it admin for this post) and a guest (limited privilege) account on each. Needless to say, admin password is known only to admins and guest password is known to all who use the lab. All these systems are configured to be able to controlled remotely (read: <a href=http://en.wikipedia.org/wiki/OpenSSH>OpenSSH</a> server is installed on each).</p><h2 id=basic-idea>Basic Idea</h2><ol><li><p>Log in via <a href=http://en.wikipedia.org/wiki/Secure_Shell>SSH</a> without a password</p></li><li><p>Write your desired command and run it in background</p></li><li><p>Run the above in a loop for the lab&rsquo;s subnet.</p></li></ol><h2 id=detailed-steps>Detailed Steps</h2><p>See <a href=http://shebang.brandonmintern.com/tips-for-remote-unix-work-ssh-screen-and-vnc>Tips for Remote Unix Work (SSH, screen, and VNC)</a> for the <strong>first step</strong> (and for more immensely useful tips on remote usage of *NIX systems).</p><p>For <strong>Step 2</strong>, here is one example command:</p><pre><code>ssh -t admin@labsystem &quot;echo  | sudo -S shutdown -h now&quot; &amp;
</code></pre><p>In the above command <em>labsystem</em> is usually replaced with an IP address like 192.168.xxx.xxx and the <em></em>with the password of the admin account.</p><p><strong>WARNING</strong>: it&rsquo;s not suggested to use the above command out in the open to save the password from prying eyes; also note that for additional security, you need to take a measure to make sure this is not saved in bash history or if the command is in a script, it&rsquo;s not accessible to others.</p><p>The requirement of ampersand at the end depends on particular usage (if you want to run, let&rsquo;s say,  <em>uptime</em> command over ssh, you would not want the output to go to background, or you can redirect the output to some file). Putting the process in background, in this case, will help in the next step.</p><p>The -S switch for sudo makes it possible to supply the password via stdin (we had discovered this switch from sudo&rsquo;s man page, but didn&rsquo;t manage to conclude &ldquo;echo pass |&rdquo; will do the trick until we discovered it at <a href=http://stackoverflow.com/questions/233217/pass-password-to-su-sudo-ssh>StackOverflow</a>)</p><p><strong>Step 3:</strong> use your favorite scripting language (bash, python, etc.) and run the above command for all the systems of your lab subnet. An example in bash:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>for</span> ip in <span style=color:#f92672>{</span>101..180<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>	ssh -t admin@192.168.xxx.$ip <span style=color:#e6db74>&#34;echo  | sudo -S shutdown -h now&#34;</span> &amp;
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>The above code snippet will run the desired command for all systems in subnet within the <a href=http://en.wikipedia.org/wiki/IP_address>IP range</a> 192.168.xxx.101 to 192.168.xxx.180. Now, you can clearly see how putting the process in the background will help - the next iteration of the loop need not wait for the command in previous iteration to finish!</p><p>In the passing, here&rsquo;s a small video I shot featuring Dhandeep when he got all excited to see this working:</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/IbO00lUPNC4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>That&rsquo;s it. Try this out, share your tricks and have some *NIX fun in your lab. :-)</p><p>PS: I have not covered how systems can be switched on with this setup. It basically involves broadcasting a <a href=http://en.wikipedia.org/wiki/Wake-on-LAN#Magic_packet>magic packet</a> to the subnet. Hope Dhandeep comes up with a blog post on that soon. ;-) Here it is: <a href=http://dhand33p.wordpress.com/2012/02/11/on-the-push-of-a-button/>On the push of a button..</a></p><p>Ciao</p><p>Kartik</p></section><span class=li-article-taxonomies>Posted
in
<a href=techglider.incategories/post>post</a>
with tags
<a href=techglider.intags/commands>commands</a>
<a href=techglider.intags/friends>friends</a>
<a href=techglider.intags/gnu/linux>gnu/linux</a>
<a href=techglider.intags/hacker>hacker</a>
<a href=techglider.intags/informative>Informative</a>
<a href=techglider.intags/innovation>innovation</a>
<a href=techglider.intags/jugaad>jugaad</a>
<a href=techglider.intags/linux>Linux</a>
<a href=techglider.intags/nit-calicut>NIT Calicut</a>
<a href=techglider.intags/programming>programming</a>
<a href=techglider.intags/terminal>terminal</a>
<a href=techglider.intags/ubuntu>ubuntu</a></span></article></div></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="techglider",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><div class="row li-pagination"><div class="eight columns"><div class=li-pagination-previous>Later article<br><a href=techglider.in/quote/2012/01/26/intension-and-extension/>Intension and Extension</a></div></div><div class="eight columns"><div class=li-pagination-next>Older article<br><a href=techglider.in/post/2012/03/26/ponderings-of-the-year-past-part-1/>Ponderings of the Year Past: Part 1</a></div></div></div></div><footer class=li-page-footer><div class=container><div class=row><div class="sixteen columns"><div class=li-page-footer-legal>Copyright © 2008-2022 Kartik Singhal.</div><div class=li-page-footer-theme><span>Built with <a href=http://gohugo.io>Hugo</a> & <a href=https://github.com/k4rtik/liquorice/>liquorice</a></span></div></div></div></div></footer><script type=text/javascript>function toggle(t){var e=document.getElementById(t);e.style.display=="block"?e.style.display="none":e.style.display="block"}</script><script type=text/javascript>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57213074-1"]),_gaq.push(["_trackPageview"]),function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)}()</script></body></html>